Function Get-IP {
    Param(
        [Parameter(Mandatory=$true)]
        [string]$VMName
    )

    # Get VM object
    $vm = Get-VM -Name $VMName

    # Get network adapter object
    $nic = Get-NetworkAdapter -VM $vm | Select -First 1

    # Get IP address, VM name, and MAC address
    $ipAddress = $nic.IPAddress
    $vmName = $vm.Name
    $macAddress = $nic.MacAddress

    # Output results
    [PSCustomObject]@{
        "IPAddress" = $ipAddress
        "VMName" = $vmName
        "MACAddress" = $macAddress
    }
}
